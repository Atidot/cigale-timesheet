<html>
<head>
	<title>
		Config
	</title>
	<script type='text/javascript' src='/static/jquery-2.0.3.min.js'></script>
	<script type='text/javascript' src='/static/jquery-ui-1.9.2.custom/js/jquery-ui-1.9.2.custom.min.js'></script>
	<script src="/static/bootstrap-3.0.0/js/bootstrap.js"></script>
	<link href="/static/jquery-ui-1.9.2.custom/css/smoothness/jquery-ui-1.9.2.custom.css" rel="stylesheet">
	<script src="/static/knockout-2.3.0.js"></script>
	<style>
		div.arrayWrap {
			border: 1px solid;
		}
		div.configblock {
			background: aliceblue;
			margin: 5px;
		}
		.removeSpan {
			float: right;
		}
		body { padding-top: 70px; }
	</style>
	<script>
	function getKeys(obj) {
		var result = [];
		for (var name in obj) {
			result.push(name);
		}
		return result;
	}
	function toJsObject(ar) {
		var result = {};
		for (var i=0;i<ar.length;i++) {
			var subarray = ar[i];
			result[subarray[0]] = subarray[1];
		}
		return result;
	}
	</script>
	<script type="text/javascript" src="/static/FayConfig.js"></script>
	<link href="/static/bootstrap-3.0.0/css/bootstrap.min.css" rel="stylesheet">
	<script type="text/html" id="configEditTemplate">
		<form role="form">
			<div class="form-group" data-bind="foreach: configAddEditVM.pluginBeingEdited().cfgPluginConfig">
				<label data-bind="text: memberName, attr: {for: memberName}"></label>
				<!-- ko if: jQuery.inArray(memberType, ["String", "Text", "ByteString", "FilePath"]) >= 0 -->
					<input type="text" class="form-control" data-bind="value: $root.configAddEditVM.configurationBeingEdited()[memberName], attr: {id: memberName}" placeholder="Enter value" value=""/>
				<!-- /ko -->
				<!-- ko if: memberType === "Password" -->
					<input class="form-control" data-bind="value:
$root.configAddEditVM.configurationBeingEdited()[memberName], attr: {id: memberName, type: $root.configAddEditVM.passwordType}" placeholder="Enter value" value=""/>
				<!-- /ko -->
			</div>
			<!-- ko if: $root.configAddEditVM.pluginBeingEditedHasPasswords -->
				<label><input type="checkbox" data-bind="checked: $root.configAddEditVM.showPasswords"/>Show passwords</label>
			<!-- /ko -->
		</form>
	</script>
	<script type="text/html" id="confirmDeleteTemplate">
		Are you sure you want to delete this data source?
	</script>
</head>
<body>
	<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
	<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			 <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="#">Cigale</a>
		</div>
		<div class="collapse navbar-collapse navbar-ex1-collapse">
			<ul class="nav navbar-nav">
				<li><a href="/">Activities</a></li>
				<li class="active"><a href="#">Event providers</a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<li class="dropdown">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown">Add module<b class="caret"></b></a>
					<ul class="dropdown-menu" id="add_module_menu" data-bind="foreach: pluginTypes">
						<li><a href="#" data-bind="text: cfgPluginName, click: function()
						{$root.addConfigItem($root, $data)}"></a></li>
					</ul>
				</li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title" data-bind="text: modalDialogVM.modalTitle"></h4>
					<div class="alert alert-danger" id="error">Error applying the change!</div>
				</div>
				<div class="modal-body" data-bind="template: { name: modalDialogVM.modalTemplate, data: $root}">
				</div>
				<!-- TODO remove the id=main-action, must do the click through knockout -->
				<div class="modal-footer">
					<button type="button" data-bind="css:modalDialogVM.actionButtonClass,text:modalDialogVM.actionButtonText"
				id="main-action"></button>
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
	<div data-bind="foreach: configSections">
		<div class='panel panel-default'><div class='panel-heading'>
				<h3 class='panel-title' data-bind="text: pluginInfo.cfgPluginName"></h3></div>
			<div class='panel-body' data-bind="foreach: userSettings">
				<div class='well well-sm'><div class='row'>
						<div class='col-xs-8' data-bind="html: $root.pluginContents($parent.pluginInfo, $data)">
				</div><div class='col-xs-4'><div class='btn-toolbar' style='float: right;'>
				<button type='button' class='btn btn-default btn-lg' data-bind="click:
					function() {$root.editConfigItem($root, $parent, $data)}">
		<span class='glyphicon glyphicon-edit'></span></button>
				<button type='button' class='btn btn-default btn-lg' data-bind="click:
					function() {$root.deleteConfigItem($parent, $data)}">
		<span class='glyphicon glyphicon-remove-circle'></span></button>
				 </div></div></div>
			</div>
		</div>
	</div>
	<div id="curConfig"><div>
</body>
</html>

